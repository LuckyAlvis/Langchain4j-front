## 一、背景与目标

为提升企业内部系统间的集成体验，减少多账号、多平台登录成本，现需实现通过企业IM工具**中海通**的统一身份认证（SSO），一键访问“耀耀工厂”（HiAgent MAAS平台），同时结合企业权限管控机制，确保未授权用户可以自主申请权限，授权后方可访问平台。

## 二、需求概述

本需求目标是：

1. 支持用户在中海通通过SSO直接登录耀耀工厂；
2. 实现权限校验机制：只有授权用户可进入耀耀工厂；
3. 为未授权用户跳转至“耀耀工厂权限申请入口”页面；
4. 支持超级管理员审批权限申请、配置访问权限。

## 三、功能需求

### 3.1 中海通登录入口

- 在中海通工作台配置“耀耀工厂”轻应用入口；
- 用户点击后发起SSO登录请求，无需重复登录。

### 3.2 SSO登录对接

- 支持中海通作为身份提供方（IdP），耀耀工厂作为服务提供方（SP）；
- 使用SAML 2.0 / OAuth 2.0 / OpenID Connect等协议完成用户身份认证；
- 登录后由耀耀工厂签发本地会话凭证（如JWT token）。

### 3.3 权限校验机制

- 中海通登录成功后，进入耀耀工厂需校验用户是否有访问权限；
- 若用户**具备权限**，则进入耀耀工厂首页；
- 若用户**无权限**，则跳转至“耀耀工厂权限申请页面”。

### 3.4 权限申请页面

- 展示用户当前基本信息（自动读取SSO传入的账号信息）；
- 用户可点击“申请访问权限”按钮，填写必要的申请理由；
- 申请提交后提示：“已提交，等待审批”；
- 支持显示“审批进度”或当前状态（如：待审批 / 已通过 / 已拒绝）。

### 3.5 权限后台管理

- 管理员登录耀耀工厂后台，可看到权限管理模块；
- 功能包括：
    - 新的权限审批单发起以后，发送通知到审批人中海通页面。
    - 查看当前所有授权用户列表；
    - 查看当前所有登录的用户；
    - 审批新的权限申请（支持批量审批通过、查看申请理由）；
    - 添加/移除用户访问权限；
    - 支持按部门、工号、姓名筛选；
    - 审批结果通过中海通通知用户。

## 四、异常与提示逻辑

| 场景              | 系统行为         | 用户提示                               |
| ----------------- | ---------------- | -------------------------------------- |
| 登录成功 + 有权限 | 跳转首页         |                                        |
| 登录成功 + 无权限 | 跳转权限申请页   | “您尚未开通访问权限，请申请”           |
| 申请成功待审批    | 页面提示         | “您的申请已提交，等待管理员审批”       |
| 审批被拒绝        | 登录仍跳转申请页 | “您的申请未通过，如有疑问请联系管理员” |

## 五、非功能性需求

### 5.1 安全要求

- 所有SSO流程通过HTTPS完成；
- 登录Token需具备时效性与签名机制；
- 后台权限管理模块具备操作日志与审批记录；

### 5.2 性能与兼容性

- 登录总耗时不超过3秒；
- 支持主流PC浏览器与移动WebView嵌套打开；
- 权限后台支持并发访问与审批操作；