<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è€€è€€å·¥å‚ - ç³»ç»Ÿæ¦‚è§ˆ</title>
    <link rel="stylesheet" href="permission-admin.css">
    <link rel="stylesheet" href="dashboard.css">
    <!-- å¼•å…¥ ECharts -->
    <script src="js/echarts.min.js"></script>
</head>
<body>
    <div class="app-container">
        <!-- ä¾§è¾¹æ  -->
        <div class="sidebar">
            <div class="sidebar-header">
                <div class="logo">
                    <img src="logo.png" alt="è€€è€€å·¥å‚">
                </div>
                <h2>è€€è€€å·¥å‚</h2>
            </div>
            <div class="sidebar-nav">
                <a href="dashboard.html" class="nav-item active">
                    <i>ğŸ“Š</i>
                    <span>ç³»ç»Ÿæ¦‚è§ˆ</span>
                </a>
                <a href="permission-admin.html" class="nav-item">
                    <i>ğŸ”‘</i>
                    <span>æƒé™ç®¡ç†</span>
                </a>
                <a href="system-logs.html" class="nav-item">
                    <i>ğŸ“</i>
                    <span>ç³»ç»Ÿæ—¥å¿—</span>
                </a>
            </div>
        </div>

        <!-- ä¸»å†…å®¹åŒºåŸŸ -->
        <div class="main-content">
            <!-- é¡¶éƒ¨å¯¼èˆª -->
            <div class="top-nav">
                <div class="breadcrumb">
                    ç³»ç»Ÿæ¦‚è§ˆ
                </div>
                <div class="user-profile">
                    <div class="user-info" onclick="toggleUserMenu()">
                        <div class="avatar">æˆ´</div>
                        <span class="username">è¶…çº§ç®¡ç†å‘˜-æˆ´å€šå‡¡</span>
                        <i class="dropdown-icon">â–¼</i>
                    </div>
                    <div class="user-menu" id="userMenu">
                        <div class="menu-item" onclick="logout()">
                            <i class="menu-icon">â†©</i>
                            <span>é€€å‡ºç™»å½•</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- æ³¨é‡Šæ‰å¹³å°ç­›é€‰åŒºåŸŸ -->
            <!--
            <div class="platform-filter-area">
                <div class="filter-label">å¹³å°é€‰æ‹©ï¼š</div>
                <div class="multi-select-container">
                    <div class="multi-select-header" id="platformSelectHeader">
                        <span class="selected-text">å…¨éƒ¨</span>
                        <span class="dropdown-icon">â–¼</span>
                    </div>
                    <div class="multi-select-dropdown" id="platformSelectDropdown">
                        <div class="multi-select-option">
                            <label>
                                <input type="checkbox" value="all" checked id="selectAllPlatforms"> å…¨éƒ¨
                            </label>
                        </div>
                        <div class="multi-select-option">
                            <label>
                                <input type="checkbox" value="1" class="platform-option"> ç¬¬ä¸€å¹³å°
                            </label>
                        </div>
                        <div class="multi-select-option">
                            <label>
                                <input type="checkbox" value="2" class="platform-option"> ç¬¬äºŒå¹³å°
                            </label>
                        </div>
                        <div class="multi-select-option">
                            <label>
                                <input type="checkbox" value="3" class="platform-option"> ç¬¬ä¸‰å¹³å°
                            </label>
                        </div>
                        <div class="multi-select-option">
                            <label>
                                <input type="checkbox" value="4" class="platform-option"> ç¬¬å››å¹³å°
                            </label>
                        </div>
                        <div class="multi-select-option">
                            <label>
                                <input type="checkbox" value="5" class="platform-option"> ç¬¬äº”å¹³å°
                            </label>
                        </div>
                    </div>
                </div>
                <button class="platform-search-btn" id="queryPlatformData">æŸ¥è¯¢</button>
            </div>
            -->

            <!-- æ³¨é‡Šæ‰æ•°æ®çœ‹æ¿ -->
            <!--
            <div class="dashboard-stats">
                <div class="stat-card">...</div>
                <div class="stat-card">...</div>
                <div class="stat-card">...</div>
                <div class="stat-card">...</div>
            </div>
            -->

            <!-- æ·»åŠ æ–°çš„åŠ¨æ€æ’åºæŠ˜çº¿å›¾å®¹å™¨ -->
            <div class="card full-width-card">
                <div class="card-header">
                    <h3 class="card-title">æ³¨å†Œäººæ•°å˜åŒ–è¶‹åŠ¿</h3>
                </div>
                <div class="card-body">
                    <div id="registrationTrendChart" class="chart-container"></div>
                </div>
            </div>

            <!-- åœ¨ç»Ÿè®¡å¡ç‰‡ä¸‹æ–¹æ·»åŠ å›¾è¡¨åŒºåŸŸï¼Œä¿ç•™åŸæœ‰çš„é¥¼å›¾ -->
            <div class="chart-row">
                <!-- å²—ä½åˆ†å¸ƒé¥¼å›¾ -->
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">å²—ä½æ€»ä½“åˆ†å¸ƒ</h3>
                    </div>
                    <div class="card-body">
                        <div id="jobDistributionChart" class="chart-container"></div>
                    </div>
                </div>

                <!-- éƒ¨é—¨åˆ†å¸ƒé¥¼å›¾ -->
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">éƒ¨é—¨æ€»ä½“åˆ†å¸ƒ</h3>
                    </div>
                    <div class="card-body">
                        <div id="userDistributionChart" class="chart-container"></div>
                    </div>
                </div>
            </div>

            <!-- æ·»åŠ æ–°çš„å¹³å°å¯¹æ¯”å›¾è¡¨åŒºåŸŸ -->
            <div class="full-width-chart-row">
                <!-- å²—ä½åˆ†å¸ƒå¯¹æ¯”æŸ±çŠ¶å›¾ -->
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">å„å¹³å°å²—ä½åˆ†å¸ƒå¯¹æ¯”</h3>
                    </div>
                    <div class="card-body">
                        <div id="jobComparisonChart" class="chart-container"></div>
                    </div>
                </div>
                
                <!-- éƒ¨é—¨åˆ†å¸ƒå¯¹æ¯”æŸ±çŠ¶å›¾ -->
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">å„å¹³å°éƒ¨é—¨åˆ†å¸ƒå¯¹æ¯”</h3>
                    </div>
                    <div class="card-body">
                        <div id="deptComparisonChart" class="chart-container"></div>
                    </div>
                </div>
            </div>

            <!-- æœ€è¿‘æ´»åŠ¨
            <div class="card">
                <div class="card-header">
                    <h3 class="card-title">æœ€è¿‘æ´»åŠ¨</h3>
                </div>
                <div class="card-body">
                    <div class="activity-list">
                        <div class="activity-item">
                            <div class="activity-icon approved">âœ“</div>
                            <div class="activity-content">
                                <div class="activity-text">
                                    <div class="activity-title">å®¡æ‰¹é€šè¿‡ - å¼ ä¸‰</div>
                                    <div class="activity-meta">
                                        <span class="activity-time">10åˆ†é’Ÿå‰</span>
                                        <span class="activity-user">æˆ´å€šå‡¡</span>
                                    </div>
                                </div>
                                <div class="activity-detail">
                                    <button class="view-detail-btn">æŸ¥çœ‹è¯¦æƒ…</button>
                                </div>
                            </div>
                        </div>
                        <div class="activity-item">
                            <div class="activity-icon login">â†’</div>
                            <div class="activity-content">
                                <div class="activity-text">
                                    <div class="activity-title">ç³»ç»Ÿç™»å½• - æå››</div>
                                    <div class="activity-meta">
                                        <span class="activity-time">30åˆ†é’Ÿå‰</span>
                                    </div>
                                </div>
                                <div class="activity-detail">
                                    <button class="view-detail-btn">æŸ¥çœ‹è¯¦æƒ…</button>
                                </div>
                            </div>
                        </div>
                        <div class="activity-item">
                            <div class="activity-icon rejected">âœ—</div>
                            <div class="activity-content">
                                <div class="activity-text">
                                    <div class="activity-title">å®¡æ‰¹æ‹’ç» - ç‹äº”</div>
                                    <div class="activity-meta">
                                        <span class="activity-time">1å°æ—¶å‰</span>
                                        <span class="activity-user">æˆ´å€šå‡¡</span>
                                    </div>
                                </div>
                                <div class="activity-detail">
                                    <button class="view-detail-btn">æŸ¥çœ‹è¯¦æƒ…</button>
                                </div>
                            </div>
                        </div>
                        <div class="activity-item">
                            <div class="activity-icon new">+</div>
                            <div class="activity-content">
                                <div class="activity-text">
                                    <div class="activity-title">æƒé™ç”³è¯· - èµµå…­</div>
                                    <div class="activity-meta">
                                        <span class="activity-time">3å°æ—¶å‰</span>
                                    </div>
                                </div>
                            </div>
                            <div class="activity-detail">
                                <button class="view-detail-btn">æŸ¥çœ‹è¯¦æƒ…</button>
                            </div>
                        </div>
                        <div class="activity-item">
                            <div class="activity-icon revoked">-</div>
                            <div class="activity-content">
                                <div class="activity-text">
                                    <div class="activity-title">æƒé™æ”¶å› - å­™ä¸ƒ</div>
                                    <div class="activity-meta">
                                        <span class="activity-time">æ˜¨å¤© 15:30</span>
                                    </div>
                                </div>
                            </div>
                            <div class="activity-detail">
                                <button class="view-detail-btn">æŸ¥çœ‹è¯¦æƒ…</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div> -->
        </div>
    </div>

    <!-- åœ¨dashboard.htmlåº•éƒ¨æ·»åŠ çš„æ¨¡æ€æ¡†ï¼Œä¸system-logs.htmlä¸­ç›¸åŒ -->
    <div id="activity-detail-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>æ“ä½œè¯¦æƒ…</h3>
                <span class="close-btn">&times;</span>
            </div>
            <div class="modal-body">
                <div class="detail-section">
                    <h4>åŸºæœ¬ä¿¡æ¯</h4>
                    <div class="detail-grid">
                        <div class="detail-item">
                            <div class="detail-label">æ“ä½œç±»å‹</div>
                            <div class="detail-value">å®¡æ‰¹é€šè¿‡</div>
                        </div>
                        <div class="detail-item">
                            <div class="detail-label">æ“ä½œæ—¶é—´</div>
                            <div class="detail-value">2023-10-26 14:35:22</div>
                        </div>
                        <div class="detail-item">
                            <div class="detail-label">æ“ä½œäºº</div>
                            <div class="detail-value">æˆ´å€šå‡¡ï¼ˆç®¡ç†å‘˜ï¼‰</div>
                        </div>
                        <div class="detail-item">
                            <div class="detail-label">IPåœ°å€</div>
                            <div class="detail-value">192.168.1.102</div>
                        </div>
                    </div>
                </div>
                
                <div class="detail-section">
                    <h4>ç”³è¯·ä¿¡æ¯</h4>
                    <div class="detail-grid">
                        <div class="detail-item">
                            <div class="detail-label">ç”³è¯·äºº</div>
                            <div class="detail-value">å¼ ä¸‰</div>
                        </div>
                        <div class="detail-item">
                            <div class="detail-label">æ‰€å±éƒ¨é—¨</div>
                            <div class="detail-value">ä¸­åœ‹å»ºç¯‰åœ‹éš›-ä¸­å»ºé¦™æ¸¯-æµ·å®æŠ€è¡“æœ‰é™å…¬å¸-æµ·å®å…¬å¸åœ˜éšŠ(é§æ·±)-æ•¸å­—åŒ–æå‡éƒ¨äºŒéƒ¨</div>
                        </div>
                        <div class="detail-item">
                            <div class="detail-label">é‚®ç®±</div>
                            <div class="detail-value">zhangsan@example.com</div>
                        </div>
                        <div class="detail-item">
                            <div class="detail-label">å²—ä½åç§°</div>
                            <div class="detail-value">é«˜çº§å¼€å‘å·¥ç¨‹å¸ˆ</div>
                        </div>
                        <div class="detail-item">
                            <div class="detail-label">é‚®ç®±</div>
                            <div class="detail-value">zhangsan@example.com</div>
                        </div>
                        <div class="detail-item">
                            <div class="detail-label">ç”³è¯·æƒé™</div>
                            <div class="detail-value">è€€è€€å·¥å‚ç™»å½•æƒé™</div>
                        </div>
                        <div class="detail-item">
                            <div class="detail-label">ç”³è¯·æ—¶é—´</div>
                            <div class="detail-value">2023-10-26 10:20:35</div>
                        </div>
                        <div class="detail-item">
                            <div class="detail-label">ç”³è¯·åŸå› </div>
                            <div class="detail-remarks">
                                å› å·¥ä½œéœ€è¦ï¼Œéœ€è¦è®¿é—®ä¸­æµ·é€šç³»ç»ŸæŸ¥è¯¢å®¢æˆ·è®¢å•æ•°æ®ï¼Œä»¥ä¾¿è¿›è¡ŒæŠ€æœ¯æ”¯æŒå’Œé—®é¢˜æ’æŸ¥ã€‚ç³»ç»Ÿä¸­çš„ç”¨æˆ·æ—¥å¿—å’Œè®¢å•æµç¨‹æ•°æ®å¯¹è§£å†³å®¢æˆ·åé¦ˆçš„é—®é¢˜è‡³å…³é‡è¦ã€‚
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="detail-section">
                    <h4>æ“ä½œå¤‡æ³¨</h4>
                    <div class="detail-remarks">
                        å·²æ ¸å®ç”¨æˆ·èº«ä»½å’Œéœ€æ±‚ï¼Œç¬¦åˆå…¬å¸å®‰å…¨æ”¿ç­–è¦æ±‚ï¼Œäºˆä»¥æ‰¹å‡†ã€‚ç”¨æˆ·æƒé™é•¿æœŸæœ‰æ•ˆã€‚
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="modal-btn cancel-btn">å…³é—­</button>
            </div>
        </div>
    </div>

    <script>
        // åœ¨document.readyä¹‹å‰ï¼Œæ·»åŠ å…¨å±€å˜é‡
        let jobComparisonChart = null;
        let deptComparisonChart = null;

        // ä¿®å¤ç³»ç»Ÿæ¦‚è§ˆé¡µé¢çš„é—®é¢˜
        document.addEventListener('DOMContentLoaded', function() {
            // ... existing code ...
            
            // ä¿®å¤é‡å¤æ´»åŠ¨é¡¹çš„é—®é¢˜
            const activityItems = document.querySelectorAll('.activity-item');
            activityItems.forEach(item => {
                const titleElement = item.querySelector('.activity-title');
                if (titleElement) {
                    // å°†"ç³»ç»Ÿç™»å½•"æ”¹ä¸º"ç™»å½•ç³»ç»Ÿ"
                    if (titleElement.textContent.includes('ç³»ç»Ÿç™»å½•')) {
                        titleElement.textContent = titleElement.textContent.replace('ç³»ç»Ÿç™»å½•', 'ç™»å½•ç³»ç»Ÿ');
                    }
                    
                    // å°†"æ”¶å›æƒé™"æ”¹ä¸º"æƒé™æ”¶å›"
                    if (titleElement.textContent.includes('æ”¶å›æƒé™')) {
                        titleElement.textContent = titleElement.textContent.replace('æ”¶å›æƒé™', 'æƒé™æ”¶å›');
                    }
                    
                    // é’ˆå¯¹æƒé™æ”¶å›æ“ä½œï¼Œç§»é™¤æ“ä½œäºº
                    if (titleElement.textContent.includes('æƒé™æ”¶å›')) {
                        const operatorElement = item.querySelector('.activity-user');
                        if (operatorElement) {
                            operatorElement.style.display = 'none';
                        }
                    }
                }
            });
            
            // ç¡®ä¿å›¾è¡¨æ­£ç¡®åˆå§‹åŒ–
            initECharts();
            initComparisonCharts();
            initRegistrationTrendChart();
        });

        // ç¡®ä¿å›¾è¡¨åˆå§‹åŒ–å‡½æ•°æ­£ç¡®å®šä¹‰
        function initECharts() {
            // åˆå§‹åŒ–éƒ¨é—¨åˆ†å¸ƒEChartså®ä¾‹
            var deptChartDom = document.getElementById('userDistributionChart');
            var deptChart = echarts.init(deptChartDom);

            // éƒ¨é—¨åˆ†å¸ƒé…ç½®é¡¹å’Œæ•°æ®
            var deptOption = {
                tooltip: {
                    trigger: 'item',
                    formatter: '{a} <br/>{b}: {c} ({d}%)'
                },
                legend: {
                    orient: 'horizontal',
                    bottom: 0,
                    data: ['ä¸­åœ‹å»ºç¯‰åœ‹éš›-ä¸­å»ºé¦™æ¸¯-æµ·å®æŠ€è¡“æœ‰é™å…¬å¸-æµ·å®å…¬å¸åœ˜éšŠ(é§æ·±)-æ•¸å­—åŒ–æå‡éƒ¨äºŒéƒ¨', 'ä¸­åœ‹å»ºç¯‰åœ‹éš›-ä¸­å»ºé¦™æ¸¯-æˆ¿å±‹å…¬å¸-æˆ¿å±‹å…¬å¸åœ˜éšŠï¼ˆé§æ·±ï¼‰', 'ä¸­åœ‹å»ºç¯‰åœ‹éš›-ä¸­å»ºæ¾³é–€-æ€»éƒ¨éƒ¨é—¨-ä¿¡æ¯åŒ–ç®¡ç†éƒ¨', 'ä¸­åœ‹å»ºç¯‰åœ‹éš›-ä¸­å»ºæ¾³é–€-æ€»éƒ¨éƒ¨é—¨-ä¿¡æ¯åŒ–ç®¡ç†éƒ¨']
                },
                series: [
                    {
                        name: 'éƒ¨é—¨åˆ†å¸ƒ',
                        type: 'pie',
                        radius: ['45%', '70%'],
                        avoidLabelOverlap: false,
                        itemStyle: {
                            borderRadius: 10,
                            borderColor: '#fff',
                            borderWidth: 2
                        },
                        label: {
                            show: false,
                            position: 'center'
                        },
                        emphasis: {
                            label: {
                                show: true,
                                fontSize: '18',
                                fontWeight: 'bold'
                            }
                        },
                        labelLine: {
                            show: false
                        },
                        data: [
                            {value: 148, name: 'ä¸­åœ‹å»ºç¯‰åœ‹éš›-ä¸­å»ºé¦™æ¸¯-æµ·å®æŠ€è¡“æœ‰é™å…¬å¸-æµ·å®å…¬å¸åœ˜éšŠ(é§æ·±)-æ•¸å­—åŒ–æå‡éƒ¨äºŒéƒ¨', itemStyle: {color: '#1890ff'}},
                            {value: 82, name: 'ä¸­åœ‹å»ºç¯‰åœ‹éš›-ä¸­å»ºé¦™æ¸¯-æˆ¿å±‹å…¬å¸-æˆ¿å±‹å…¬å¸åœ˜éšŠï¼ˆé§æ·±ï¼‰', itemStyle: {color: '#faad14'}},
                            {value: 66, name: 'ä¸­åœ‹å»ºç¯‰åœ‹éš›-ä¸­å»ºæ¾³é–€-æ€»éƒ¨éƒ¨é—¨-ä¿¡æ¯åŒ–ç®¡ç†éƒ¨', itemStyle: {color: '#722ed1'}},
                            {value: 32, name: 'ä¸­åœ‹å»ºç¯‰åœ‹éš›-ä¸­å»ºæ¾³é–€-æ€»éƒ¨éƒ¨é—¨-ä¿¡æ¯åŒ–ç®¡ç†éƒ¨', itemStyle: {color: '#bfbfbf'}}
                        ]
                    }
                ]
            };

            // ä½¿ç”¨é…ç½®é¡¹æ˜¾ç¤ºéƒ¨é—¨åˆ†å¸ƒå›¾è¡¨
            deptChart.setOption(deptOption);

            // åˆå§‹åŒ–å²—ä½åˆ†å¸ƒEChartså®ä¾‹
            var jobChartDom = document.getElementById('jobDistributionChart');
            var jobChart = echarts.init(jobChartDom);

            // å²—ä½åˆ†å¸ƒé…ç½®é¡¹å’Œæ•°æ®
            var jobOption = {
                tooltip: {
                    trigger: 'item',
                    formatter: '{a} <br/>{b}: {c} ({d}%)'
                },
                legend: {
                    orient: 'horizontal',
                    bottom: 0,
                    data: ['æŠ€æœ¯å¼€å‘ä¸»ä»»', 'åŠ©ç†æŠ€æœ¯å¼€å‘ä¸»ä»»', 'åŠ©ç†æ€»ç»ç†', 'åŠ©ç†æŠ€æœ¯å¼€å‘ç»ç†', 'é«˜çº§Javaå¼€å‘å·¥ç¨‹å¸ˆ']
                },
                series: [
                    {
                        name: 'å²—ä½åˆ†å¸ƒ',
                        type: 'pie',
                        radius: ['45%', '70%'],
                        avoidLabelOverlap: false,
                        itemStyle: {
                            borderRadius: 10,
                            borderColor: '#fff',
                            borderWidth: 2
                        },
                        label: {
                            show: false,
                            position: 'center'
                        },
                        emphasis: {
                            label: {
                                show: true,
                                fontSize: '18',
                                fontWeight: 'bold'
                            }
                        },
                        labelLine: {
                            show: false
                        },
                        data: [
                            {value: 120, name: 'æŠ€æœ¯å¼€å‘ä¸»ä»»', itemStyle: {color: '#52c41a'}},
                            {value: 56, name: 'åŠ©ç†æŠ€æœ¯å¼€å‘ä¸»ä»»', itemStyle: {color: '#13c2c2'}},
                            {value: 42, name: 'åŠ©ç†æ€»ç»ç†', itemStyle: {color: '#eb2f96'}},
                            {value: 68, name: 'åŠ©ç†æŠ€æœ¯å¼€å‘ç»ç†', itemStyle: {color: '#faad14'}},
                            {value: 42, name: 'é«˜çº§Javaå¼€å‘å·¥ç¨‹å¸ˆ', itemStyle: {color: '#2C4CDD'}}
                        ]
                    }
                ]
            };

            // ä½¿ç”¨é…ç½®é¡¹æ˜¾ç¤ºå²—ä½åˆ†å¸ƒå›¾è¡¨
            jobChart.setOption(jobOption);
        }

        // æ·»åŠ åˆå§‹åŒ–å¯¹æ¯”å›¾è¡¨å‡½æ•°
        function initComparisonCharts() {
            // åˆå§‹åŒ–å²—ä½åˆ†å¸ƒå¯¹æ¯”å›¾
            const jobCompDom = document.getElementById('jobComparisonChart');
            if (jobCompDom) {
                jobComparisonChart = echarts.init(jobCompDom);
                
                // åŸºç¡€é…ç½®
                const jobCompOption = {
                    tooltip: {
                        trigger: 'axis',
                        axisPointer: {
                            type: 'shadow'
                        },
                        formatter: function(params) {
                            let result = params[0].name + '<br/>';
                            let total = 0;
                            
                            params.forEach(param => {
                                total += param.value;
                                const colorSpan = `<span style="display:inline-block;margin-right:5px;border-radius:10px;width:10px;height:10px;background-color:${param.color};"></span>`;
                                result += colorSpan + param.seriesName + ': ' + param.value + ' (' + ((param.value / total) * 100).toFixed(1) + '%)<br/>';
                            });
                            
                            result += `<b>æ€»è®¡: ${total}</b>`;
                            return result;
                        }
                    },
                    legend: {
                        data: ['æŠ€æœ¯å¼€å‘ä¸»ä»»', 'åŠ©ç†æŠ€æœ¯å¼€å‘ä¸»ä»»', 'åŠ©ç†æ€»ç»ç†', 'åŠ©ç†æŠ€æœ¯å¼€å‘ç»ç†', 'é«˜çº§Javaå¼€å‘å·¥ç¨‹å¸ˆ'],
                        right: 10,
                        top: 10
                    },
                    grid: {
                        left: '3%',
                        right: '4%',
                        bottom: '15%',
                        top: '15%',
                        containLabel: true
                    },
                    yAxis: {
                        type: 'category',
                        data: ['ç¬¬ä¸€å¹³å°', 'ç¬¬äºŒå¹³å°', 'ç¬¬ä¸‰å¹³å°', 'ç¬¬å››å¹³å°', 'ç¬¬äº”å¹³å°'],
                        axisLabel: {
                            interval: 0
                        }
                    },
                    xAxis: {
                        type: 'value',
                        name: 'äººæ•°',
                        nameLocation: 'end'
                    },
                    series: [
                        {
                            name: 'æŠ€æœ¯å¼€å‘ä¸»ä»»',
                            type: 'bar',
                            stack: 'æ€»é‡',
                            emphasis: {
                                focus: 'series'
                            },
                            itemStyle: {color: '#52c41a'},
                            data: [65, 30, 15, 8, 2],
                            label: {
                                show: false,
                                position: 'insideRight'
                            }
                        },
                        {
                            name: 'åŠ©ç†æŠ€æœ¯å¼€å‘ä¸»ä»»',
                            type: 'bar',
                            stack: 'æ€»é‡',
                            emphasis: {
                                focus: 'series'
                            },
                            itemStyle: {color: '#13c2c2'},
                            data: [25, 18, 12, 5, 1],
                            label: {
                                show: false,
                                position: 'insideRight'
                            }
                        },
                        {
                            name: 'åŠ©ç†æ€»ç»ç†',
                            type: 'bar',
                            stack: 'æ€»é‡',
                            emphasis: {
                                focus: 'series'
                            },
                            itemStyle: {color: '#eb2f96'},
                            data: [20, 15, 8, 3, 1],
                            label: {
                                show: false,
                                position: 'insideRight'
                            }
                        },
                        {
                            name: 'åŠ©ç†æŠ€æœ¯å¼€å‘ç»ç†',
                            type: 'bar',
                            stack: 'æ€»é‡',
                            emphasis: {
                                focus: 'series'
                            },
                            itemStyle: {color: '#faad14'},
                            data: [30, 20, 12, 6, 2],
                            label: {
                                show: false,
                                position: 'insideRight'
                            }
                        },
                        {
                            name: 'é«˜çº§Javaå¼€å‘å·¥ç¨‹å¸ˆ',
                            type: 'bar',
                            stack: 'æ€»é‡',
                            emphasis: {
                                focus: 'series'
                            },
                            itemStyle: {color: '#2C4CDD'},
                            data: [15, 10, 5, 2, 0],
                            label: {
                                show: false,
                                position: 'insideRight'
                            }
                        }
                    ]
                };
                
                jobComparisonChart.setOption(jobCompOption);
            }
            
            // åˆå§‹åŒ–éƒ¨é—¨åˆ†å¸ƒå¯¹æ¯”å›¾
            const deptCompDom = document.getElementById('deptComparisonChart');
            if (deptCompDom) {
                deptComparisonChart = echarts.init(deptCompDom);
                
                // åŸºç¡€é…ç½®
                const deptCompOption = {
                    tooltip: {
                        trigger: 'axis',
                        axisPointer: {
                            type: 'shadow'
                        },
                        formatter: function(params) {
                            let result = params[0].name + '<br/>';
                            let total = 0;
                            
                            params.forEach(param => {
                                total += param.value;
                                const colorSpan = `<span style="display:inline-block;margin-right:5px;border-radius:10px;width:10px;height:10px;background-color:${param.color};"></span>`;
                                result += colorSpan + param.seriesName + ': ' + param.value + ' (' + ((param.value / total) * 100).toFixed(1) + '%)<br/>';
                            });
                            
                            result += `<b>æ€»è®¡: ${total}</b>`;
                            return result;
                        }
                    },
                    legend: {
                        data: ['ä¸­åœ‹å»ºç¯‰åœ‹éš›-ä¸­å»ºé¦™æ¸¯-æµ·å®æŠ€è¡“æœ‰é™å…¬å¸-æµ·å®å…¬å¸åœ˜éšŠ(é§æ·±)-æ•¸å­—åŒ–æå‡éƒ¨äºŒéƒ¨', 'ä¸­åœ‹å»ºç¯‰åœ‹éš›-ä¸­å»ºé¦™æ¸¯-æˆ¿å±‹å…¬å¸-æˆ¿å±‹å…¬å¸åœ˜éšŠï¼ˆé§æ·±ï¼‰', 'ä¸­åœ‹å»ºç¯‰åœ‹éš›-ä¸­å»ºæ¾³é–€-æ€»éƒ¨éƒ¨é—¨-ä¿¡æ¯åŒ–ç®¡ç†éƒ¨', 'ä¸­åœ‹å»ºç¯‰åœ‹éš›-ä¸­å»ºæ¾³é–€-æ€»éƒ¨éƒ¨é—¨-ä¿¡æ¯åŒ–ç®¡ç†éƒ¨'],
                        right: 10,
                        top: 10
                    },
                    grid: {
                        left: '3%',
                        right: '4%',
                        bottom: '15%',
                        top: '15%',
                        containLabel: true
                    },
                    yAxis: {
                        type: 'category',
                        data: ['ç¬¬ä¸€å¹³å°', 'ç¬¬äºŒå¹³å°'],
                        axisLabel: {
                            interval: 0
                        }
                    },
                    xAxis: {
                        type: 'value',
                        name: 'äººæ•°',
                        nameLocation: 'end'
                    },
                    series: [
                        {
                            name: 'ä¸­åœ‹å»ºç¯‰åœ‹éš›-ä¸­å»ºé¦™æ¸¯-æµ·å®æŠ€è¡“æœ‰é™å…¬å¸-æµ·å®å…¬å¸åœ˜éšŠ(é§æ·±)-æ•¸å­—åŒ–æå‡éƒ¨äºŒéƒ¨',
                            type: 'bar',
                            stack: 'æ€»é‡',
                            emphasis: {
                                focus: 'series'
                            },
                            itemStyle: {color: '#1890ff'},
                            data: [70, 35, 20, 10, 3],
                            label: {
                                show: false,
                                position: 'insideRight'
                            }
                        },
                        {
                            name: 'ä¸­åœ‹å»ºç¯‰åœ‹éš›-ä¸­å»ºé¦™æ¸¯-æˆ¿å±‹å…¬å¸-æˆ¿å±‹å…¬å¸åœ˜éšŠï¼ˆé§æ·±ï¼‰',
                            type: 'bar',
                            stack: 'æ€»é‡',
                            emphasis: {
                                focus: 'series'
                            },
                            itemStyle: {color: '#faad14'},
                            data: [35, 25, 15, 8, 2],
                            label: {
                                show: false,
                                position: 'insideRight'
                            }
                        },
                        {
                            name: 'ä¸­åœ‹å»ºç¯‰åœ‹éš›-ä¸­å»ºæ¾³é–€-æ€»éƒ¨éƒ¨é—¨-ä¿¡æ¯åŒ–ç®¡ç†éƒ¨',
                            type: 'bar',
                            stack: 'æ€»é‡',
                            emphasis: {
                                focus: 'series'
                            },
                            itemStyle: {color: '#722ed1'},
                            data: [30, 20, 12, 5, 1],
                            label: {
                                show: false,
                                position: 'insideRight'
                            }
                        },
                        {
                            name: 'ä¸­åœ‹å»ºç¯‰åœ‹éš›-ä¸­å»ºæ¾³é–€-æ€»éƒ¨éƒ¨é—¨-ä¿¡æ¯åŒ–ç®¡ç†éƒ¨',
                            type: 'bar',
                            stack: 'æ€»é‡',
                            emphasis: {
                                focus: 'series'
                            },
                            itemStyle: {color: '#bfbfbf'},
                            data: [15, 8, 4, 2, 0],
                            label: {
                                show: false,
                                position: 'insideRight'
                            }
                        }
                    ]
                };
                
                deptComparisonChart.setOption(deptCompOption);
            }
        }

        // æ·»åŠ æ›´æ–°å¯¹æ¯”å›¾è¡¨å‡½æ•°
        function updateComparisonCharts(platformIds) {
            const platformNames = {
                '1': 'ç¬¬ä¸€å¹³å°',
                '2': 'ç¬¬äºŒå¹³å°',
                '3': 'ç¬¬ä¸‰å¹³å°',
                '4': 'ç¬¬å››å¹³å°',
                '5': 'ç¬¬äº”å¹³å°'
            };
            
            // ç­›é€‰å¹¶æ’åºé€‰ä¸­çš„å¹³å°
            const selectedPlatformNames = platformIds.map(id => platformNames[id]).filter(Boolean);
            
            // å‡†å¤‡å²—ä½åˆ†å¸ƒæ•°æ®
            const jobSeriesData = {};
            const jobCategories = ['æŠ€æœ¯å¼€å‘ä¸»ä»»', 'åŠ©ç†æŠ€æœ¯å¼€å‘ä¸»ä»»', 'åŠ©ç†æ€»ç»ç†', 'åŠ©ç†æŠ€æœ¯å¼€å‘ç»ç†', 'é«˜çº§Javaå¼€å‘å·¥ç¨‹å¸ˆ'];
            
            // åˆå§‹åŒ–æ•°æ®ç»“æ„
            jobCategories.forEach(category => {
                jobSeriesData[category] = [];
            });
            
            // å¡«å……å„å¹³å°å„å²—ä½çš„æ•°æ®
            platformIds.forEach(platformId => {
                const platformData = window.platformData[platformId];
                
                jobCategories.forEach(category => {
                    const categoryData = platformData.jobDistribution.find(item => item.name === category);
                    jobSeriesData[category].push(categoryData ? categoryData.value : 0);
                });
            });
            
            // æ›´æ–°å²—ä½åˆ†å¸ƒå¯¹æ¯”å›¾
            if (jobComparisonChart) {
                jobComparisonChart.setOption({
                    yAxis: {
                        data: selectedPlatformNames
                    },
                    series: [
                        {
                            name: 'æŠ€æœ¯å¼€å‘ä¸»ä»»',
                            data: jobSeriesData['æŠ€æœ¯å¼€å‘ä¸»ä»»']
                        },
                        {
                            name: 'åŠ©ç†æŠ€æœ¯å¼€å‘ä¸»ä»»',
                            data: jobSeriesData['åŠ©ç†æŠ€æœ¯å¼€å‘ä¸»ä»»']
                        },
                        {
                            name: 'åŠ©ç†æ€»ç»ç†',
                            data: jobSeriesData['åŠ©ç†æ€»ç»ç†']
                        },
                        {
                            name: 'åŠ©ç†æŠ€æœ¯å¼€å‘ç»ç†',
                            data: jobSeriesData['åŠ©ç†æŠ€æœ¯å¼€å‘ç»ç†']
                        },
                        {
                            name: 'é«˜çº§Javaå¼€å‘å·¥ç¨‹å¸ˆ',
                            data: jobSeriesData['é«˜çº§Javaå¼€å‘å·¥ç¨‹å¸ˆ']
                        }
                    ]
                });
            }
            
            // å‡†å¤‡éƒ¨é—¨åˆ†å¸ƒæ•°æ®
            const deptSeriesData = {};
            const deptCategories = ['ä¸­åœ‹å»ºç¯‰åœ‹éš›-ä¸­å»ºé¦™æ¸¯-æµ·å®æŠ€è¡“æœ‰é™å…¬å¸-æµ·å®å…¬å¸åœ˜éšŠ(é§æ·±)-æ•¸å­—åŒ–æå‡éƒ¨äºŒéƒ¨', 'ä¸­åœ‹å»ºç¯‰åœ‹éš›-ä¸­å»ºé¦™æ¸¯-æˆ¿å±‹å…¬å¸-æˆ¿å±‹å…¬å¸åœ˜éšŠï¼ˆé§æ·±ï¼‰', 'ä¸­åœ‹å»ºç¯‰åœ‹éš›-ä¸­å»ºæ¾³é–€-æ€»éƒ¨éƒ¨é—¨-ä¿¡æ¯åŒ–ç®¡ç†éƒ¨', 'ä¸­åœ‹å»ºç¯‰åœ‹éš›-ä¸­å»ºæ¾³é–€-æ€»éƒ¨éƒ¨é—¨-ä¿¡æ¯åŒ–ç®¡ç†éƒ¨'];
            
            // åˆå§‹åŒ–æ•°æ®ç»“æ„
            deptCategories.forEach(category => {
                deptSeriesData[category] = [];
            });
            
            // å¡«å……å„å¹³å°å„éƒ¨é—¨çš„æ•°æ®
            platformIds.forEach(platformId => {
                const platformData = window.platformData[platformId];
                
                deptCategories.forEach(category => {
                    const categoryData = platformData.deptDistribution.find(item => item.name === category);
                    deptSeriesData[category].push(categoryData ? categoryData.value : 0);
                });
            });
            
            // æ›´æ–°éƒ¨é—¨åˆ†å¸ƒå¯¹æ¯”å›¾
            if (deptComparisonChart) {
                deptComparisonChart.setOption({
                    yAxis: {
                        data: selectedPlatformNames
                    },
                    series: [
                        {
                            name: 'ä¸­åœ‹å»ºç¯‰åœ‹éš›-ä¸­å»ºé¦™æ¸¯-æµ·å®æŠ€è¡“æœ‰é™å…¬å¸-æµ·å®å…¬å¸åœ˜éšŠ(é§æ·±)-æ•¸å­—åŒ–æå‡éƒ¨äºŒéƒ¨',
                            data: deptSeriesData['ä¸­åœ‹å»ºç¯‰åœ‹éš›-ä¸­å»ºé¦™æ¸¯-æµ·å®æŠ€è¡“æœ‰é™å…¬å¸-æµ·å®å…¬å¸åœ˜éšŠ(é§æ·±)-æ•¸å­—åŒ–æå‡éƒ¨äºŒéƒ¨']
                        },
                        {
                            name: 'ä¸­åœ‹å»ºç¯‰åœ‹éš›-ä¸­å»ºé¦™æ¸¯-æˆ¿å±‹å…¬å¸-æˆ¿å±‹å…¬å¸åœ˜éšŠï¼ˆé§æ·±ï¼‰',
                            data: deptSeriesData['ä¸­åœ‹å»ºç¯‰åœ‹éš›-ä¸­å»ºé¦™æ¸¯-æˆ¿å±‹å…¬å¸-æˆ¿å±‹å…¬å¸åœ˜éšŠï¼ˆé§æ·±ï¼‰']
                        },
                        {
                            name: 'ä¸­åœ‹å»ºç¯‰åœ‹éš›-ä¸­å»ºæ¾³é–€-æ€»éƒ¨éƒ¨é—¨-ä¿¡æ¯åŒ–ç®¡ç†éƒ¨',
                            data: deptSeriesData['ä¸­åœ‹å»ºç¯‰åœ‹éš›-ä¸­å»ºæ¾³é–€-æ€»éƒ¨éƒ¨é—¨-ä¿¡æ¯åŒ–ç®¡ç†éƒ¨']
                        },
                        {
                            name: 'ä¸­åœ‹å»ºç¯‰åœ‹éš›-ä¸­å»ºæ¾³é–€-æ€»éƒ¨éƒ¨é—¨-ä¿¡æ¯åŒ–ç®¡ç†éƒ¨',
                            data: deptSeriesData['ä¸­åœ‹å»ºç¯‰åœ‹éš›-ä¸­å»ºæ¾³é–€-æ€»éƒ¨éƒ¨é—¨-ä¿¡æ¯åŒ–ç®¡ç†éƒ¨']
                        }
                    ]
                });
            }
        }

        // ç”¨æˆ·èœå•ç›¸å…³åŠŸèƒ½
        function toggleUserMenu() {
            const menu = document.getElementById('userMenu');
            if (menu.style.display === 'block') {
                menu.style.display = 'none';
            } else {
                menu.style.display = 'block';
            }
        }

        // ç‚¹å‡»é¡µé¢å…¶ä»–åœ°æ–¹å…³é—­èœå•
        document.addEventListener('click', function (event) {
            const userInfo = document.querySelector('.user-info');
            const userMenu = document.getElementById('userMenu');

            if (!userInfo.contains(event.target) && userMenu.style.display === 'block') {
                userMenu.style.display = 'none';
            }
        }, true);

        function logout() {
            if (confirm('ç¡®å®šè¦é€€å‡ºç™»å½•å—ï¼Ÿ')) {
                window.location.href = 'login.html';
            }
        }

        // ç¡®ä¿åœ¨DOMå®Œå…¨åŠ è½½åæ‰§è¡Œ
        document.addEventListener('DOMContentLoaded', function() {
            // è·å–æ¨¡æ€æ¡†å’Œç›¸å…³å…ƒç´ 
            const activityModal = document.getElementById('activity-detail-modal');
            
            // ç¡®ä¿æ¨¡æ€æ¡†å­˜åœ¨
            if (!activityModal) {
                console.error('æ´»åŠ¨è¯¦æƒ…æ¨¡æ€æ¡†ä¸å­˜åœ¨');
                return;
            }
            
            const detailButtons = document.querySelectorAll('.activity-detail .view-detail-btn');
            const closeBtn = activityModal.querySelector('.close-btn');
            const cancelBtn = activityModal.querySelector('.modal-btn.cancel-btn');
            
            console.log('æ‰¾åˆ°æŸ¥çœ‹è¯¦æƒ…æŒ‰é’®æ•°é‡:', detailButtons.length); // è°ƒè¯•ä¿¡æ¯
            
            // ä¸ºæ‰€æœ‰æŸ¥çœ‹è¯¦æƒ…æŒ‰é’®æ·»åŠ ç‚¹å‡»äº‹ä»¶
            detailButtons.forEach(button => {
                button.addEventListener('click', function(event) {
                    event.preventDefault(); // é˜²æ­¢æŒ‰é’®é»˜è®¤è¡Œä¸º
                    
                    // è·å–æ´»åŠ¨ç±»å‹
                    const activityItem = this.closest('.activity-item');
                    
                    if (!activityItem) {
                        console.error('æ— æ³•æ‰¾åˆ°çˆ¶çº§æ´»åŠ¨é¡¹å…ƒç´ ');
                        return;
                    }
                    
                    const activityIcon = activityItem.querySelector('.activity-icon');
                    const activityTitle = activityItem.querySelector('.activity-title');
                    
                    if (!activityIcon || !activityTitle) {
                        console.error('æ´»åŠ¨å›¾æ ‡æˆ–æ ‡é¢˜ä¸å­˜åœ¨');
                        return;
                    }
                    
                    console.log('ç‚¹å‡»æŸ¥çœ‹è¯¦æƒ…:', activityTitle.textContent); // è°ƒè¯•ä¿¡æ¯
                    
                    // æ ¹æ®ç±»å‹è®¾ç½®ä¸åŒçš„æ¨¡æ€æ¡†å†…å®¹
                    updateActivityModalContent(activityIcon.className, activityTitle.textContent);
                    
                    // æ˜¾ç¤ºæ¨¡æ€æ¡†
                    activityModal.style.display = 'flex';
                });
            });
            
            // æ ¹æ®æ´»åŠ¨ç±»å‹æ›´æ–°æ¨¡æ€æ¡†å†…å®¹
            function updateActivityModalContent(iconClass, title) {
                console.log('æ›´æ–°æ¨¡æ€æ¡†å†…å®¹:', iconClass, title); // è°ƒè¯•ä¿¡æ¯
                
                // è®¾ç½®æ¨¡æ€æ¡†æ ‡é¢˜
                const modalTitle = activityModal.querySelector('.modal-header h3');
                if (modalTitle) {
                    modalTitle.textContent = title.includes('-') ? 
                        title.split('-')[0].trim() + 'è¯¦æƒ…' : 'æ“ä½œè¯¦æƒ…';
                }
                
                // è·å–ç”³è¯·äººåç§°
                let userName = '';
                if (title.includes('-')) {
                    userName = title.split('-')[1].trim();
                } else if (title.includes('çš„')) {
                    userName = title.split('çš„')[0].trim();
                }
                
                // æ ¹æ®ç”¨æˆ·åè®¾ç½®ç›¸å…³ä¿¡æ¯
                let jobId = 'ZH001';
                let department = 'ä¸­åœ‹å»ºç¯‰åœ‹éš›-ä¸­å»ºé¦™æ¸¯-æµ·å®æŠ€è¡“æœ‰é™å…¬å¸-æµ·å®å…¬å¸åœ˜éšŠ(é§æ·±)-æ•¸å­—åŒ–æå‡éƒ¨äºŒéƒ¨';
                let position = 'é«˜çº§å¼€å‘å·¥ç¨‹å¸ˆ';
                let email = 'zhangsan@example.com';
                
                // æ ¹æ®ä¸åŒç”¨æˆ·è®¾ç½®ä¸åŒä¿¡æ¯
                if (userName.includes('æå››')) {
                    jobId = 'ZH002';
                    department = 'ä¸­åœ‹å»ºç¯‰åœ‹éš›-ä¸­å»ºé¦™æ¸¯-æˆ¿å±‹å…¬å¸-æˆ¿å±‹å…¬å¸åœ˜éšŠï¼ˆé§æ·±ï¼‰';
                    position = 'å¸‚åœºä¸“å‘˜';
                    email = 'lisi@example.com';
                } else if (userName.includes('ç‹äº”')) {
                    jobId = 'ZH003';
                    department = 'ä¸­åœ‹å»ºç¯‰åœ‹éš›-ä¸­å»ºæ¾³é–€-æ€»éƒ¨éƒ¨é—¨-ä¿¡æ¯åŒ–ç®¡ç†éƒ¨';
                    position = 'åŠ©ç†æŠ€æœ¯å¼€å‘ä¸»ä»»';
                    email = 'wangwu@example.com';
                } else if (userName.includes('èµµå…­')) {
                    jobId = 'ZH004';
                    department = 'ä¸­åœ‹å»ºç¯‰åœ‹éš›-ä¸­å»ºé¦™æ¸¯-äººåŠ›èµ„æºéƒ¨';
                    position = 'HRä¸“å‘˜';
                    email = 'zhaoliu@example.com';
                } else if (userName.includes('é’±ä¸ƒ')) {
                    jobId = 'ZH005';
                    department = 'ä¸­åœ‹å»ºç¯‰åœ‹éš›-ä¸­å»ºé¦™æ¸¯-æµ·å®æŠ€è¡“æœ‰é™å…¬å¸-æµ·å®å…¬å¸åœ˜éšŠ(é§æ·±)-æ•¸å­—åŒ–æå‡éƒ¨äºŒéƒ¨';
                    position = 'å¼€å‘å·¥ç¨‹å¸ˆ';
                    email = 'qianqi@example.com';
                }
                
                // æ›´æ–°ç”¨æˆ·ç›¸å…³ä¿¡æ¯
                const detailItems = activityModal.querySelectorAll('.detail-item');
                detailItems.forEach(item => {
                    const label = item.querySelector('.detail-label');
                    const value = item.querySelector('.detail-value');
                    
                    if (label && value) {
                        if (label.textContent === 'ç”³è¯·äºº') {
                            value.textContent = userName;
                        } else if (label.textContent === 'é‚®ç®±') {
                            value.textContent = jobId;
                        } else if (label.textContent === 'æ‰€å±éƒ¨é—¨') {
                            value.textContent = department;
                        } else if (label.textContent === 'å²—ä½åç§°') {
                            value.textContent = position;
                        } else if (label.textContent === 'é‚®ç®±') {
                            value.textContent = email;
                        }
                    }
                });
                
                // è·å–å¤‡æ³¨éƒ¨åˆ†å…ƒç´ 
                const remarkSection = activityModal.querySelector('.detail-section:nth-of-type(4)');
                if (!remarkSection) {
                    console.error('æ— æ³•æ‰¾åˆ°å¤‡æ³¨éƒ¨åˆ†');
                    return;
                }
                
                const remarkContent = remarkSection.querySelector('.detail-remarks');
                
                // è·å–ç”³è¯·åŸå› éƒ¨åˆ†å…ƒç´ 
                const reasonSection = activityModal.querySelector('.detail-section:nth-of-type(3)');
                
                // æ ¹æ®å›¾æ ‡ç±»ååˆ¤æ–­æ´»åŠ¨ç±»å‹
                if (iconClass.includes('approved')) {
                    // å®¡æ‰¹é€šè¿‡
                    remarkSection.querySelector('h4').textContent = 'å®¡æ‰¹å¤‡æ³¨';
                    remarkContent.textContent = 'å·²æ ¸å®ç”¨æˆ·èº«ä»½å’Œéœ€æ±‚ï¼Œç¬¦åˆå…¬å¸å®‰å…¨æ”¿ç­–è¦æ±‚ï¼Œäºˆä»¥æ‰¹å‡†ã€‚ç”¨æˆ·æƒé™é•¿æœŸæœ‰æ•ˆã€‚';
                    remarkContent.style.borderLeftColor = '#52c41a'; // ç»¿è‰²
                    remarkContent.style.backgroundColor = '#f6ffed';
                    reasonSection.style.display = 'block'; // æ˜¾ç¤ºç”³è¯·åŸå› 
                } 
                else if (iconClass.includes('rejected')) {
                    // å®¡æ‰¹æ‹’ç»
                    remarkSection.querySelector('h4').textContent = 'æ‹’ç»ç†ç”±';
                    remarkContent.textContent = 'ç”³è¯·ç”¨é€”ä¸ç”¨æˆ·å²—ä½èŒè´£ä¸ç¬¦ï¼Œæ— æ³•ç¡®è®¤ä¸šåŠ¡éœ€æ±‚çš„çœŸå®æ€§ã€‚å»ºè®®ç”±éƒ¨é—¨ä¸»ç®¡é‡æ–°æäº¤ç”³è¯·å¹¶è¯¦ç»†è¯´æ˜ä¸šåŠ¡éœ€æ±‚ã€‚';
                    remarkContent.style.borderLeftColor = '#f5222d'; // çº¢è‰²
                    remarkContent.style.backgroundColor = '#fff1f0';
                    reasonSection.style.display = 'block'; // æ˜¾ç¤ºç”³è¯·åŸå› 
                }
                else if (iconClass.includes('login')) {
                    // ç™»å½•æ“ä½œ
                    remarkSection.querySelector('h4').textContent = 'ç™»å½•ä¿¡æ¯';
                    remarkContent.textContent = 'ç™»å½•æˆåŠŸã€‚è®¾å¤‡ä¿¡æ¯ï¼šWindows 10ï¼ŒChrome æµè§ˆå™¨ã€‚ç™»å½•ä½ç½®ï¼šå…¬å¸å†…ç½‘ï¼ŒIPåœ°å€åŒ¹é…å¸¸ç”¨ä½ç½®ã€‚';
                    remarkContent.style.borderLeftColor = '#1890ff'; // è“è‰²
                    remarkContent.style.backgroundColor = '#e6f7ff';
                    reasonSection.style.display = 'none'; // éšè—ç”³è¯·åŸå› 
                }
                else if (iconClass.includes('new')) {
                    // æ–°ç”³è¯·
                    remarkSection.querySelector('h4').textContent = 'ç”³è¯·çŠ¶æ€';
                    remarkContent.textContent = 'ç”³è¯·å·²æäº¤ï¼Œç­‰å¾…ç®¡ç†å‘˜å®¡æ‰¹ã€‚é¢„è®¡å¤„ç†æ—¶é—´ï¼š24å°æ—¶å†…ã€‚';
                    remarkContent.style.borderLeftColor = '#faad14'; // é»„è‰²
                    remarkContent.style.backgroundColor = '#fffbe6';
                    reasonSection.style.display = 'block'; // æ˜¾ç¤ºç”³è¯·åŸå› 
                }
                else if (iconClass.includes('revoked')) {
                    // æ”¶å›æƒé™
                    remarkSection.querySelector('h4').textContent = 'æ“ä½œå¤‡æ³¨';
                    remarkContent.textContent = 'æ ¹æ®å…¬å¸æƒé™ç®¡ç†è§„å®šï¼Œç”¨æˆ·30å¤©æœªä½¿ç”¨è¯¥æƒé™ï¼Œç³»ç»Ÿè‡ªåŠ¨æ”¶å›ã€‚ç”¨æˆ·å¯é‡æ–°ç”³è¯·ã€‚';
                    remarkContent.style.borderLeftColor = '#bfbfbf'; // ç°è‰²
                    remarkContent.style.backgroundColor = '#fafafa';
                    reasonSection.style.display = 'none'; // éšè—ç”³è¯·åŸå› 
                }
                
                // è°ƒæ•´ç”³è¯·ä¿¡æ¯éƒ¨åˆ†çš„æ˜¾ç¤ºä¸éšè—
                const appInfoSection = activityModal.querySelector('.detail-section:nth-of-type(2)');
                if (iconClass.includes('login')) {
                    // ç™»å½•æ“ä½œä¸æ˜¾ç¤ºç”³è¯·ä¿¡æ¯ï¼Œè€Œæ˜¯æ˜¾ç¤ºç”¨æˆ·ä¿¡æ¯
                    appInfoSection.querySelector('h4').textContent = 'ç”¨æˆ·ä¿¡æ¯';
                    appInfoSection.querySelectorAll('.detail-item').forEach((item, index) => {
                        const label = item.querySelector('.detail-label');
                        const value = item.querySelector('.detail-value');
                        
                        switch(index) {
                            case 0:
                                label.textContent = 'ç”¨æˆ·å';
                                value.textContent = 'æå››';
                                break;
                            case 1:
                                label.textContent = 'æ‰€å±éƒ¨é—¨';
                                value.textContent = 'ä¸­åœ‹å»ºç¯‰åœ‹éš›-ä¸­å»ºé¦™æ¸¯-æˆ¿å±‹å…¬å¸-æˆ¿å±‹å…¬å¸åœ˜éšŠï¼ˆé§æ·±ï¼‰';
                                break;
                            case 2:
                                label.textContent = 'ç”¨æˆ·è§’è‰²';
                                value.textContent = 'æ™®é€šç”¨æˆ·';
                                break;
                            case 3:
                                label.textContent = 'ç™»å½•æ—¶é—´';
                                value.textContent = '2023-10-26 14:30:22';
                                break;
                        }
                    });
                } else {
                    // å…¶ä»–æ“ä½œæ˜¾ç¤ºç”³è¯·ä¿¡æ¯
                    appInfoSection.querySelector('h4').textContent = 'ç”³è¯·ä¿¡æ¯';
                    
                    // æ ¹æ®æ ‡é¢˜è·å–ç”¨æˆ·å
                    let userName = 'å¼ ä¸‰'; // é»˜è®¤
                    if (title.includes('-')) {
                        userName = title.split('-')[1].trim().split('çš„')[0];
                    }
                    
                    appInfoSection.querySelectorAll('.detail-item').forEach((item, index) => {
                        const label = item.querySelector('.detail-label');
                        const value = item.querySelector('.detail-value');
                        
                        switch(index) {
                            case 0:
                                label.textContent = 'ç”³è¯·äºº';
                                value.textContent = userName;
                                break;
                            case 1:
                                label.textContent = 'æ‰€å±éƒ¨é—¨';
                                value.textContent = userName === 'å¼ ä¸‰' ? 'ä¸­åœ‹å»ºç¯‰åœ‹éš›-ä¸­å»ºé¦™æ¸¯-æµ·å®æŠ€è¡“æœ‰é™å…¬å¸-æµ·å®å…¬å¸åœ˜éšŠ(é§æ·±)-æ•¸å­—åŒ–æå‡éƒ¨äºŒéƒ¨' : 
                                                    userName === 'ç‹äº”' ? 'è´¢åŠ¡éƒ¨' : 
                                                    userName === 'èµµå…­' ? 'ä¸­åœ‹å»ºç¯‰åœ‹éš›-ä¸­å»ºæ¾³é–€-æ€»éƒ¨éƒ¨é—¨-ä¿¡æ¯åŒ–ç®¡ç†éƒ¨' : 'ä¸­åœ‹å»ºç¯‰åœ‹éš›-ä¸­å»ºé¦™æ¸¯-æˆ¿å±‹å…¬å¸-æˆ¿å±‹å…¬å¸åœ˜éšŠï¼ˆé§æ·±ï¼‰';
                                break;
                            case 2:
                                label.textContent = 'é‚®ç®±';
                                value.textContent = 'zhangsan@example.com';
                                break;
                            case 3:
                                label.textContent = 'å²—ä½åç§°';
                                value.textContent = 'é«˜çº§å¼€å‘å·¥ç¨‹å¸ˆ';
                                break;
                            case 4:
                                label.textContent = 'é‚®ç®±';
                                value.textContent = 'zhangsan@example.com';
                                break;
                            case 5:
                                label.textContent = 'ç”³è¯·æƒé™';
                                value.textContent = 'ä¸­æµ·é€šç™»å½•æƒé™';
                                break;
                            case 6:
                                label.textContent = 'ç”³è¯·æ—¶é—´';
                                value.textContent = '2023-10-26 10:20:35';
                                break;
                        }
                    });
                }
            }
            
            // å…³é—­æ¨¡æ€æ¡†çš„äº‹ä»¶å¤„ç†
            if (closeBtn) {
                closeBtn.addEventListener('click', () => {
                    activityModal.style.display = 'none';
                });
            }
            
            if (cancelBtn) {
                cancelBtn.addEventListener('click', () => {
                    activityModal.style.display = 'none';
                });
            }
            
            window.addEventListener('click', (event) => {
                if (event.target === activityModal) {
                    activityModal.style.display = 'none';
                }
            });
        });

        // å¹³å°æ•°æ® - æ¨¡æ‹Ÿå„å¹³å°çš„æ•°æ®
        const platformData = {
            all: {
                onlineUsers: 42,
                dailyVisits: 256,
                pendingApprovals: 15,
                authorizedUsers: 328,
                jobDistribution: [
                    {value: 120, name: 'æŠ€æœ¯å¼€å‘ä¸»ä»»', itemStyle: {color: '#52c41a'}},
                    {value: 56, name: 'åŠ©ç†æŠ€æœ¯å¼€å‘ä¸»ä»»', itemStyle: {color: '#13c2c2'}},
                    {value: 42, name: 'åŠ©ç†æ€»ç»ç†', itemStyle: {color: '#eb2f96'}},
                    {value: 68, name: 'åŠ©ç†æŠ€æœ¯å¼€å‘ç»ç†', itemStyle: {color: '#faad14'}},
                    {value: 42, name: 'é«˜çº§Javaå¼€å‘å·¥ç¨‹å¸ˆ', itemStyle: {color: '#2C4CDD'}}
                ],
                deptDistribution: [
                    {value: 148, name: 'ä¸­åœ‹å»ºç¯‰åœ‹éš›-ä¸­å»ºé¦™æ¸¯-æµ·å®æŠ€è¡“æœ‰é™å…¬å¸-æµ·å®å…¬å¸åœ˜éšŠ(é§æ·±)-æ•¸å­—åŒ–æå‡éƒ¨äºŒéƒ¨', itemStyle: {color: '#1890ff'}},
                    {value: 82, name: 'ä¸­åœ‹å»ºç¯‰åœ‹éš›-ä¸­å»ºé¦™æ¸¯-æˆ¿å±‹å…¬å¸-æˆ¿å±‹å…¬å¸åœ˜éšŠï¼ˆé§æ·±ï¼‰', itemStyle: {color: '#faad14'}},
                    {value: 66, name: 'ä¸­åœ‹å»ºç¯‰åœ‹éš›-ä¸­å»ºæ¾³é–€-æ€»éƒ¨éƒ¨é—¨-ä¿¡æ¯åŒ–ç®¡ç†éƒ¨', itemStyle: {color: '#722ed1'}},
                    {value: 32, name: 'ä¸­åœ‹å»ºç¯‰åœ‹éš›-ä¸­å»ºæ¾³é–€-æ€»éƒ¨éƒ¨é—¨-ä¿¡æ¯åŒ–ç®¡ç†éƒ¨', itemStyle: {color: '#bfbfbf'}}
                ]
            },
            1: {
                onlineUsers: 18,
                dailyVisits: 112,
                pendingApprovals: 7,
                authorizedUsers: 145,
                jobDistribution: [
                    {value: 65, name: 'æŠ€æœ¯å¼€å‘ä¸»ä»»', itemStyle: {color: '#52c41a'}},
                    {value: 25, name: 'åŠ©ç†æŠ€æœ¯å¼€å‘ä¸»ä»»', itemStyle: {color: '#13c2c2'}},
                    {value: 18, name: 'åŠ©ç†æ€»ç»ç†', itemStyle: {color: '#eb2f96'}},
                    {value: 22, name: 'åŠ©ç†æŠ€æœ¯å¼€å‘ç»ç†', itemStyle: {color: '#faad14'}},
                    {value: 15, name: 'é«˜çº§Javaå¼€å‘å·¥ç¨‹å¸ˆ', itemStyle: {color: '#2C4CDD'}}
                ],
                deptDistribution: [
                    {value: 75, name: 'ä¸­åœ‹å»ºç¯‰åœ‹éš›-ä¸­å»ºé¦™æ¸¯-æµ·å®æŠ€è¡“æœ‰é™å…¬å¸-æµ·å®å…¬å¸åœ˜éšŠ(é§æ·±)-æ•¸å­—åŒ–æå‡éƒ¨äºŒéƒ¨', itemStyle: {color: '#1890ff'}},
                    {value: 35, name: 'ä¸­åœ‹å»ºç¯‰åœ‹éš›-ä¸­å»ºé¦™æ¸¯-æˆ¿å±‹å…¬å¸-æˆ¿å±‹å…¬å¸åœ˜éšŠï¼ˆé§æ·±ï¼‰', itemStyle: {color: '#faad14'}},
                    {value: 25, name: 'ä¸­åœ‹å»ºç¯‰åœ‹éš›-ä¸­å»ºæ¾³é–€-æ€»éƒ¨éƒ¨é—¨-ä¿¡æ¯åŒ–ç®¡ç†éƒ¨', itemStyle: {color: '#722ed1'}},
                    {value: 10, name: 'ä¸­åœ‹å»ºç¯‰åœ‹éš›-ä¸­å»ºæ¾³é–€-æ€»éƒ¨éƒ¨é—¨-ä¿¡æ¯åŒ–ç®¡ç†éƒ¨', itemStyle: {color: '#bfbfbf'}}
                ]
            },
            2: {
                onlineUsers: 12,
                dailyVisits: 84,
                pendingApprovals: 4,
                authorizedUsers: 93,
                jobDistribution: [
                    {value: 30, name: 'æŠ€æœ¯å¼€å‘ä¸»ä»»', itemStyle: {color: '#52c41a'}},
                    {value: 16, name: 'åŠ©ç†æŠ€æœ¯å¼€å‘ä¸»ä»»', itemStyle: {color: '#13c2c2'}},
                    {value: 12, name: 'åŠ©ç†æ€»ç»ç†', itemStyle: {color: '#eb2f96'}},
                    {value: 25, name: 'åŠ©ç†æŠ€æœ¯å¼€å‘ç»ç†', itemStyle: {color: '#faad14'}},
                    {value: 10, name: 'é«˜çº§Javaå¼€å‘å·¥ç¨‹å¸ˆ', itemStyle: {color: '#2C4CDD'}}
                ],
                deptDistribution: [
                    {value: 38, name: 'ä¸­åœ‹å»ºç¯‰åœ‹éš›-ä¸­å»ºé¦™æ¸¯-æµ·å®æŠ€è¡“æœ‰é™å…¬å¸-æµ·å®å…¬å¸åœ˜éšŠ(é§æ·±)-æ•¸å­—åŒ–æå‡éƒ¨äºŒéƒ¨', itemStyle: {color: '#1890ff'}},
                    {value: 28, name: 'ä¸­åœ‹å»ºç¯‰åœ‹éš›-ä¸­å»ºé¦™æ¸¯-æˆ¿å±‹å…¬å¸-æˆ¿å±‹å…¬å¸åœ˜éšŠï¼ˆé§æ·±ï¼‰', itemStyle: {color: '#faad14'}},
                    {value: 18, name: 'ä¸­åœ‹å»ºç¯‰åœ‹éš›-ä¸­å»ºæ¾³é–€-æ€»éƒ¨éƒ¨é—¨-ä¿¡æ¯åŒ–ç®¡ç†éƒ¨', itemStyle: {color: '#722ed1'}},
                    {value: 9, name: 'ä¸­åœ‹å»ºç¯‰åœ‹éš›-ä¸­å»ºæ¾³é–€-æ€»éƒ¨éƒ¨é—¨-ä¿¡æ¯åŒ–ç®¡ç†éƒ¨', itemStyle: {color: '#bfbfbf'}}
                ]
            },
            3: {
                onlineUsers: 8,
                dailyVisits: 32,
                pendingApprovals: 2,
                authorizedUsers: 45,
                jobDistribution: [
                    {value: 15, name: 'æŠ€æœ¯å¼€å‘ä¸»ä»»', itemStyle: {color: '#52c41a'}},
                    {value: 8, name: 'åŠ©ç†æŠ€æœ¯å¼€å‘ä¸»ä»»', itemStyle: {color: '#13c2c2'}},
                    {value: 7, name: 'åŠ©ç†æ€»ç»ç†', itemStyle: {color: '#eb2f96'}},
                    {value: 10, name: 'åŠ©ç†æŠ€æœ¯å¼€å‘ç»ç†', itemStyle: {color: '#faad14'}},
                    {value: 5, name: 'é«˜çº§Javaå¼€å‘å·¥ç¨‹å¸ˆ', itemStyle: {color: '#2C4CDD'}}
                ],
                deptDistribution: [
                    {value: 20, name: 'ä¸­åœ‹å»ºç¯‰åœ‹éš›-ä¸­å»ºé¦™æ¸¯-æµ·å®æŠ€è¡“æœ‰é™å…¬å¸-æµ·å®å…¬å¸åœ˜éšŠ(é§æ·±)-æ•¸å­—åŒ–æå‡éƒ¨äºŒéƒ¨', itemStyle: {color: '#1890ff'}},
                    {value: 12, name: 'ä¸­åœ‹å»ºç¯‰åœ‹éš›-ä¸­å»ºé¦™æ¸¯-æˆ¿å±‹å…¬å¸-æˆ¿å±‹å…¬å¸åœ˜éšŠï¼ˆé§æ·±ï¼‰', itemStyle: {color: '#faad14'}},
                    {value: 10, name: 'ä¸­åœ‹å»ºç¯‰åœ‹éš›-ä¸­å»ºæ¾³é–€-æ€»éƒ¨éƒ¨é—¨-ä¿¡æ¯åŒ–ç®¡ç†éƒ¨', itemStyle: {color: '#722ed1'}},
                    {value: 3, name: 'ä¸­åœ‹å»ºç¯‰åœ‹éš›-ä¸­å»ºæ¾³é–€-æ€»éƒ¨éƒ¨é—¨-ä¿¡æ¯åŒ–ç®¡ç†éƒ¨', itemStyle: {color: '#bfbfbf'}}
                ]
            },
            4: {
                onlineUsers: 3,
                dailyVisits: 18,
                pendingApprovals: 1,
                authorizedUsers: 25,
                jobDistribution: [
                    {value: 8, name: 'æŠ€æœ¯å¼€å‘ä¸»ä»»', itemStyle: {color: '#52c41a'}},
                    {value: 5, name: 'åŠ©ç†æŠ€æœ¯å¼€å‘ä¸»ä»»', itemStyle: {color: '#13c2c2'}},
                    {value: 3, name: 'åŠ©ç†æ€»ç»ç†', itemStyle: {color: '#eb2f96'}},
                    {value: 6, name: 'åŠ©ç†æŠ€æœ¯å¼€å‘ç»ç†', itemStyle: {color: '#faad14'}},
                    {value: 3, name: 'é«˜çº§Javaå¼€å‘å·¥ç¨‹å¸ˆ', itemStyle: {color: '#2C4CDD'}}
                ],
                deptDistribution: [
                    {value: 10, name: 'ä¸­åœ‹å»ºç¯‰åœ‹éš›-ä¸­å»ºé¦™æ¸¯-æµ·å®æŠ€è¡“æœ‰é™å…¬å¸-æµ·å®å…¬å¸åœ˜éšŠ(é§æ·±)-æ•¸å­—åŒ–æå‡éƒ¨äºŒéƒ¨', itemStyle: {color: '#1890ff'}},
                    {value: 5, name: 'ä¸­åœ‹å»ºç¯‰åœ‹éš›-ä¸­å»ºé¦™æ¸¯-æˆ¿å±‹å…¬å¸-æˆ¿å±‹å…¬å¸åœ˜éšŠï¼ˆé§æ·±ï¼‰', itemStyle: {color: '#faad14'}},
                    {value: 7, name: 'ä¸­åœ‹å»ºç¯‰åœ‹éš›-ä¸­å»ºæ¾³é–€-æ€»éƒ¨éƒ¨é—¨-ä¿¡æ¯åŒ–ç®¡ç†éƒ¨', itemStyle: {color: '#722ed1'}},
                    {value: 3, name: 'ä¸­åœ‹å»ºç¯‰åœ‹éš›-ä¸­å»ºæ¾³é–€-æ€»éƒ¨éƒ¨é—¨-ä¿¡æ¯åŒ–ç®¡ç†éƒ¨', itemStyle: {color: '#bfbfbf'}}
                ]
            },
            5: {
                onlineUsers: 1,
                dailyVisits: 10,
                pendingApprovals: 1,
                authorizedUsers: 20,
                jobDistribution: [
                    {value: 2, name: 'æŠ€æœ¯å¼€å‘ä¸»ä»»', itemStyle: {color: '#52c41a'}},
                    {value: 2, name: 'åŠ©ç†æŠ€æœ¯å¼€å‘ä¸»ä»»', itemStyle: {color: '#13c2c2'}},
                    {value: 2, name: 'åŠ©ç†æ€»ç»ç†', itemStyle: {color: '#eb2f96'}},
                    {value: 5, name: 'åŠ©ç†æŠ€æœ¯å¼€å‘ç»ç†', itemStyle: {color: '#faad14'}},
                    {value: 9, name: 'é«˜çº§Javaå¼€å‘å·¥ç¨‹å¸ˆ', itemStyle: {color: '#2C4CDD'}}
                ],
                deptDistribution: [
                    {value: 5, name: 'ä¸­åœ‹å»ºç¯‰åœ‹éš›-ä¸­å»ºé¦™æ¸¯-æµ·å®æŠ€è¡“æœ‰é™å…¬å¸-æµ·å®å…¬å¸åœ˜éšŠ(é§æ·±)-æ•¸å­—åŒ–æå‡éƒ¨äºŒéƒ¨', itemStyle: {color: '#1890ff'}},
                    {value: 2, name: 'ä¸­åœ‹å»ºç¯‰åœ‹éš›-ä¸­å»ºé¦™æ¸¯-æˆ¿å±‹å…¬å¸-æˆ¿å±‹å…¬å¸åœ˜éšŠï¼ˆé§æ·±ï¼‰', itemStyle: {color: '#faad14'}},
                    {value: 6, name: 'ä¸­åœ‹å»ºç¯‰åœ‹éš›-ä¸­å»ºæ¾³é–€-æ€»éƒ¨éƒ¨é—¨-ä¿¡æ¯åŒ–ç®¡ç†éƒ¨', itemStyle: {color: '#722ed1'}},
                    {value: 7, name: 'ä¸­åœ‹å»ºç¯‰åœ‹éš›-ä¸­å»ºæ¾³é–€-æ€»éƒ¨éƒ¨é—¨-ä¿¡æ¯åŒ–ç®¡ç†éƒ¨', itemStyle: {color: '#bfbfbf'}}
                ]
            }
        };
        
        // å¹³å°é€‰æ‹©ç›¸å…³é€»è¾‘
        document.addEventListener('DOMContentLoaded', function() {
            // è·å–DOMå…ƒç´ 
            const selectAllCheckbox = document.getElementById('selectAllPlatforms');
            const platformOptions = document.querySelectorAll('.platform-option');
            const queryButton = document.getElementById('queryPlatformData');
            
            const multiSelectHeader = document.getElementById('platformSelectHeader');
            const multiSelectDropdown = document.getElementById('platformSelectDropdown');
            const selectedTextSpan = multiSelectHeader.querySelector('.selected-text');
            
            // ç‚¹å‡»å¤´éƒ¨æ‰“å¼€/å…³é—­ä¸‹æ‹‰æ¡†
            multiSelectHeader.addEventListener('click', function(e) {
                e.stopPropagation();
                multiSelectHeader.classList.toggle('active');
                multiSelectDropdown.classList.toggle('visible');
            });
            
            // ç‚¹å‡»å…¶ä»–åœ°æ–¹å…³é—­ä¸‹æ‹‰æ¡†
            document.addEventListener('click', function() {
                multiSelectHeader.classList.remove('active');
                multiSelectDropdown.classList.remove('visible');
            });
            
            // é˜²æ­¢ç‚¹å‡»ä¸‹æ‹‰æ¡†å†…éƒ¨æ—¶å…³é—­ä¸‹æ‹‰æ¡†
            multiSelectDropdown.addEventListener('click', function(e) {
                e.stopPropagation();
            });
            
            // å…¨é€‰/å–æ¶ˆå…¨é€‰
            selectAllCheckbox.addEventListener('change', function() {
                platformOptions.forEach(option => {
                    option.checked = this.checked;
                    option.disabled = this.checked;
                });
                
                // æ›´æ–°é€‰ä¸­æ–‡æœ¬
                updateSelectedText();
            });
            
            // å•ä¸ªå¹³å°é€‰æ‹©æ—¶æ›´æ–°å…¨é€‰çŠ¶æ€
            platformOptions.forEach(option => {
                option.addEventListener('change', function() {
                    // å¦‚æœå–æ¶ˆå‹¾é€‰æŸä¸ªå¹³å°ï¼Œåˆ™å–æ¶ˆå…¨é€‰
                    if (!this.checked && selectAllCheckbox.checked) {
                        selectAllCheckbox.checked = false;
                        platformOptions.forEach(opt => {
                            opt.disabled = false;
                        });
                    }
                    
                    // å¦‚æœæ‰€æœ‰å¹³å°éƒ½è¢«é€‰ä¸­ï¼Œåˆ™è‡ªåŠ¨å‹¾é€‰å…¨é€‰
                    const allSelected = Array.from(platformOptions).every(opt => opt.checked);
                    if (allSelected) {
                        selectAllCheckbox.checked = true;
                        platformOptions.forEach(opt => {
                            opt.disabled = true;
                        });
                    }
                    
                    // æ›´æ–°é€‰ä¸­æ–‡æœ¬
                    updateSelectedText();
                });
            });
            
            // æ›´æ–°é€‰ä¸­å¹³å°çš„æ˜¾ç¤ºæ–‡æœ¬
            function updateSelectedText() {
                if (selectAllCheckbox.checked) {
                    selectedTextSpan.textContent = 'å…¨éƒ¨';
                    return;
                }
                
                const selectedPlatforms = Array.from(platformOptions)
                    .filter(option => option.checked)
                    .map(option => {
                        // é€šè¿‡æŸ¥æ‰¾ç›¸é‚»æ–‡æœ¬è·å–å¹³å°åç§°
                        return option.parentNode.textContent.trim();
                    });
                
                if (selectedPlatforms.length === 0) {
                    selectedTextSpan.textContent = 'è¯·é€‰æ‹©å¹³å°';
                } else if (selectedPlatforms.length <= 2) {
                    selectedTextSpan.textContent = selectedPlatforms.join('ã€');
                } else {
                    selectedTextSpan.textContent = `å·²é€‰æ‹© ${selectedPlatforms.length} ä¸ªå¹³å°`;
                }
            }
            
            // æŸ¥è¯¢æŒ‰é’®ç‚¹å‡»äº‹ä»¶
            queryButton.addEventListener('click', function() {
                // å…³é—­ä¸‹æ‹‰æ¡†
                multiSelectHeader.classList.remove('active');
                multiSelectDropdown.classList.remove('visible');
                
                updateDashboard();
            });
            
            // åˆå§‹åŠ è½½æ—¶æ›´æ–°ä»ªè¡¨ç›˜
            updateDashboard();
        });
        
        // æ ¹æ®é€‰æ‹©çš„å¹³å°æ›´æ–°ä»ªè¡¨ç›˜æ•°æ®
        function updateDashboard() {
            const selectAllCheckbox = document.getElementById('selectAllPlatforms');
            const platformOptions = document.querySelectorAll('.platform-option');
            
            // å¦‚æœé€‰æ‹©äº†"å…¨éƒ¨"ï¼Œç›´æ¥ä½¿ç”¨å…¨éƒ¨æ•°æ®
            if (selectAllCheckbox.checked) {
                updateStatCards(platformData.all);
                updatePieCharts(platformData.all);
                updateComparisonCharts(Object.keys(platformData).filter(key => key !== 'all'));
                return;
            }
            
            // è·å–é€‰ä¸­çš„å¹³å°
            const selectedPlatforms = Array.from(platformOptions)
                .filter(option => option.checked)
                .map(option => option.value);
            
            // å¦‚æœæ²¡æœ‰é€‰æ‹©å¹³å°ï¼Œæ˜¾ç¤ºæç¤ºå¹¶è¿”å›
            if (selectedPlatforms.length === 0) {
                alert('è¯·è‡³å°‘é€‰æ‹©ä¸€ä¸ªå¹³å°');
                return;
            }
            
            // åˆå¹¶é€‰ä¸­å¹³å°çš„æ•°æ®
            const mergedData = mergeSelectedPlatformsData(selectedPlatforms);
            
            // æ›´æ–°ç»Ÿè®¡å¡ç‰‡å’Œé¥¼å›¾
            updateStatCards(mergedData);
            updatePieCharts(mergedData);
            
            // æ›´æ–°å¯¹æ¯”å›¾è¡¨
            updateComparisonCharts(selectedPlatforms);
        }
        
        // åˆå¹¶é€‰ä¸­å¹³å°çš„æ•°æ®
        function mergeSelectedPlatformsData(platforms) {
            // åˆå§‹åŒ–åˆå¹¶åçš„æ•°æ®ç»“æ„
            const merged = {
                onlineUsers: 0,
                dailyVisits: 0,
                pendingApprovals: 0,
                authorizedUsers: 0,
                jobDistribution: [],
                deptDistribution: []
            };
            
            // åˆå¹¶æ•°å­—ç»Ÿè®¡
            platforms.forEach(platform => {
                const data = platformData[platform];
                merged.onlineUsers += data.onlineUsers;
                merged.dailyVisits += data.dailyVisits;
                merged.pendingApprovals += data.pendingApprovals;
                merged.authorizedUsers += data.authorizedUsers;
            });
            
            // åˆå¹¶å²—ä½åˆ†å¸ƒæ•°æ®
            const jobCategories = ['æŠ€æœ¯å¼€å‘ä¸»ä»»', 'åŠ©ç†æŠ€æœ¯å¼€å‘ä¸»ä»»', 'åŠ©ç†æ€»ç»ç†', 'åŠ©ç†æŠ€æœ¯å¼€å‘ç»ç†', 'é«˜çº§Javaå¼€å‘å·¥ç¨‹å¸ˆ'];
            const jobColors = ['#52c41a', '#13c2c2', '#eb2f96', '#faad14', '#2C4CDD'];
            
            jobCategories.forEach((category, index) => {
                const totalValue = platforms.reduce((sum, platform) => {
                    const categoryData = platformData[platform].jobDistribution.find(item => item.name === category);
                    return sum + (categoryData ? categoryData.value : 0);
                }, 0);
                
                merged.jobDistribution.push({
                    value: totalValue,
                    name: category,
                    itemStyle: {color: jobColors[index]}
                });
            });
            
            // åˆå¹¶éƒ¨é—¨åˆ†å¸ƒæ•°æ®
            const deptCategories = ['ä¸­åœ‹å»ºç¯‰åœ‹éš›-ä¸­å»ºé¦™æ¸¯-æµ·å®æŠ€è¡“æœ‰é™å…¬å¸-æµ·å®å…¬å¸åœ˜éšŠ(é§æ·±)-æ•¸å­—åŒ–æå‡éƒ¨äºŒéƒ¨', 'ä¸­åœ‹å»ºç¯‰åœ‹éš›-ä¸­å»ºé¦™æ¸¯-æˆ¿å±‹å…¬å¸-æˆ¿å±‹å…¬å¸åœ˜éšŠï¼ˆé§æ·±ï¼‰', 'ä¸­åœ‹å»ºç¯‰åœ‹éš›-ä¸­å»ºæ¾³é–€-æ€»éƒ¨éƒ¨é—¨-ä¿¡æ¯åŒ–ç®¡ç†éƒ¨', 'ä¸­åœ‹å»ºç¯‰åœ‹éš›-ä¸­å»ºæ¾³é–€-æ€»éƒ¨éƒ¨é—¨-ä¿¡æ¯åŒ–ç®¡ç†éƒ¨'];
            const deptColors = ['#1890ff', '#faad14', '#722ed1', '#bfbfbf'];
            
            deptCategories.forEach((category, index) => {
                const totalValue = platforms.reduce((sum, platform) => {
                    const categoryData = platformData[platform].deptDistribution.find(item => item.name === category);
                    return sum + (categoryData ? categoryData.value : 0);
                }, 0);
                
                merged.deptDistribution.push({
                    value: totalValue,
                    name: category,
                    itemStyle: {color: deptColors[index]}
                });
            });
            
            return merged;
        }
        
        // æ›´æ–°ç»Ÿè®¡å¡ç‰‡
        function updateStatCards(data) {
            document.querySelector('.stat-value:nth-child(1)').textContent = data.onlineUsers;
            document.querySelector('.dashboard-stats .stat-card:nth-child(2) .stat-value').textContent = data.dailyVisits;
            document.querySelector('.dashboard-stats .stat-card:nth-child(3) .stat-value').textContent = data.pendingApprovals;
            document.querySelector('.dashboard-stats .stat-card:nth-child(4) .stat-value').textContent = data.authorizedUsers;
        }
        
        // æ›´æ–°é¥¼å›¾ (åŸupdateChartså‡½æ•°æ”¹å)
        function updatePieCharts(data) {
            // æ›´æ–°å²—ä½åˆ†å¸ƒé¥¼å›¾
            const jobChart = echarts.getInstanceByDom(document.getElementById('jobDistributionChart'));
            if (jobChart) {
                jobChart.setOption({
                    series: [{
                        data: data.jobDistribution
                    }]
                });
            }
            
            // æ›´æ–°éƒ¨é—¨åˆ†å¸ƒé¥¼å›¾
            const deptChart = echarts.getInstanceByDom(document.getElementById('userDistributionChart'));
            if (deptChart) {
                deptChart.setOption({
                    series: [{
                        data: data.deptDistribution
                    }]
                });
            }
        }

        // åˆå§‹åŒ–åŠ¨æ€æ’åºæŠ˜çº¿å›¾
        function initRegistrationTrendChart() {
            const chartDom = document.getElementById('registrationTrendChart');
            if (!chartDom) return;
            
            const myChart = echarts.init(chartDom);
            
            // å¹³å°åˆ—è¡¨
            const platforms = [
                'ç¬¬ä¸€å¹³å°',
                'ç¬¬äºŒå¹³å°'
            ];
            
            // å¹³å°é¢œè‰²æ˜ å°„
            const platformColors = {
                'ç¬¬ä¸€å¹³å°': '#1890ff',
                'ç¬¬äºŒå¹³å°': '#52c41a',
                'ç¬¬ä¸‰å¹³å°': '#faad14',
                'ç¬¬å››å¹³å°': '#f5222d',
                'ç¬¬äº”å¹³å°': '#722ed1'
            };
            
            // ç”Ÿæˆæ¨¡æ‹Ÿæ•°æ® - 30å¤©çš„å„å¹³å°æ³¨å†Œäººæ•°
            const generateMockData = () => {
                const now = new Date('2025-04-23'); // å›ºå®šæ—¥æœŸï¼Œé¿å…æ¯æ¬¡åˆ·æ–°å˜åŒ–
                const data = [];
                
                // ä¸ºæ¯ä¸ªå¹³å°ç”ŸæˆåŸºç¡€è¶‹åŠ¿
                const baseTrends = {
                    'ç¬¬ä¸€å¹³å°': { base: 150, growth: 1.3, variance: 20 },
                    'ç¬¬äºŒå¹³å°': { base: 100, growth: 1.3, variance: 15 },
                    'ç¬¬ä¸‰å¹³å°': { base: 70, growth: 1.3, variance: 10 },
                    'ç¬¬å››å¹³å°': { base: 40, growth: 1.2, variance: 8 },
                    'ç¬¬äº”å¹³å°': { base: 20, growth: 1.1, variance: 5 }
                };
                
                // ç”Ÿæˆ30å¤©çš„æ•°æ®
                for (let i = 29; i >= 0; i--) {
                    const date = new Date(now);
                    date.setDate(date.getDate() - i);
                    const dateStr = date.toISOString().slice(0, 10);
                    
                    platforms.forEach(platform => {
                        const trend = baseTrends[platform];
                        const dayNum = 30 - i;
                        
                        // è®¡ç®—å½“å¤©æ³¨å†Œæ•°ï¼ˆåŸºç¡€å€¼ + å¢é•¿ + éšæœºæ³¢åŠ¨ï¼‰
                        const base = trend.base;
                        const growth = Math.pow(trend.growth, dayNum / 5); // ä½¿å¢é•¿æ›´åŠ å¹³æ»‘
                        const variance = Math.random() * trend.variance * 2 - trend.variance;
                        
                        const registrations = Math.floor(base * growth + variance);
                        
                        data.push({
                            Date: dateStr,
                            Platform: platform,
                            Registrations: Math.max(1, registrations) // ç¡®ä¿è‡³å°‘æœ‰1ä¸ªæ³¨å†Œ
                        });
                    });
                }
                
                return data;
            };
            
            const rawData = generateMockData();
            
            // åœ¨åˆ›å»ºç³»åˆ—ä¹‹å‰ï¼Œé¢„å…ˆè®¡ç®—æ¯ä¸ªå¹³å°æœ€åä¸€å¤©çš„æ•°æ®
            const lastDayData = {};
            platforms.forEach(platform => {
                const platformData = rawData.filter(d => d.Platform === platform);
                const sortedData = platformData.sort((a, b) => new Date(b.Date) - new Date(a.Date));
                lastDayData[platform] = sortedData[0].Registrations;
            });
            
            // ä¸ºæ¯ä¸ªå¹³å°åˆ›å»ºæ•°æ®é›†å’Œç³»åˆ—
            const datasetWithFilters = [];
            const seriesList = [];
            
            platforms.forEach(platform => {
                const datasetId = 'dataset_' + platform.replace(/\s+/g, '_');
                
                datasetWithFilters.push({
                    id: datasetId,
                    fromDatasetId: 'dataset_raw',
                    transform: {
                        type: 'filter',
                        config: {
                            dimension: 'Platform', 
                            '=': platform
                        }
                    }
                });
                
                seriesList.push({
                    type: 'line',
                    datasetId: datasetId,
                    showSymbol: false,
                    name: platform,
                    // æŒ‡å®šçº¿æ¡é¢œè‰²ï¼Œä¿æŒä¸€è‡´æ€§
                    lineStyle: {
                        color: platformColors[platform]
                    },
                    itemStyle: {
                        color: platformColors[platform]
                    },
                    endLabel: {
                        show: true,
                        formatter: function(params) {
                            // æ›´å¥å£®çš„æ•°æ®æå–æ–¹å¼
                            let registrationValue;
                            
                            // æ£€æŸ¥ä¸åŒå¯èƒ½çš„æ•°æ®ç»“æ„
                            if (typeof params.value === 'object') {
                                if (params.value.Registrations !== undefined) {
                                    // å¦‚æœæ˜¯å¯¹è±¡æ ¼å¼ {Date, Platform, Registrations}
                                    registrationValue = params.value.Registrations;
                                } else if (Array.isArray(params.value) && params.value.length > 2) {
                                    // å¦‚æœæ˜¯æ•°ç»„æ ¼å¼ [Date, Platform, Registrations]
                                    registrationValue = params.value[2];
                                } else {
                                    // å¤‡ç”¨ï¼Œå°è¯•ä»åŸå§‹æ•°æ®ä¸­è·å–
                                    const lastData = rawData.filter(d => 
                                        d.Platform === platform).sort((a, b) => 
                                        new Date(b.Date) - new Date(a.Date))[0];
                                    
                                    registrationValue = lastData ? lastData.Registrations : '';
                                }
                            } else {
                                // ç›´æ¥ä½¿ç”¨å€¼
                                registrationValue = params.value;
                            }
                            
                            return platform + ': ' + (registrationValue !== undefined ? registrationValue : '');
                        },
                        backgroundColor: '#fff',
                        padding: [3, 5],
                        borderRadius: 3,
                        shadowColor: 'rgba(0, 0, 0, 0.1)',
                        shadowBlur: 3
                    },
                    labelLayout: {
                        moveOverlap: 'shiftY',
                        draggable: true
                    },
                    emphasis: {
                        focus: 'series'
                    },
                    encode: {
                        x: 'Date',
                        y: 'Registrations',
                        label: ['Platform', 'Registrations'],
                        itemName: 'Date',
                        tooltip: ['Registrations']
                    }
                });
            });
            
            const option = {
                animationDuration: 300,
                dataset: [
                    {
                        id: 'dataset_raw',
                        source: rawData
                    },
                    ...datasetWithFilters
                ],
                title: {
                    text: 'è¿‘30å¤©æ³¨å†Œäººæ•°å˜åŒ–è¶‹åŠ¿',
                    left: 'center'
                },
                tooltip: {
                    order: 'valueDesc',
                    trigger: 'axis',
                    formatter: function(params) {
                        let result = params[0].axisValue + '<br>';
                        
                        // æŒ‰æ•°å€¼ä»å¤§åˆ°å°æ’åº
                        params.sort((a, b) => {
                            // ä¿®å¤ï¼šç¡®ä¿æˆ‘ä»¬è·å–çš„æ˜¯æ•°å­—è€Œä¸æ˜¯undefined
                            const valueA = typeof a.value[2] === 'number' ? a.value[2] : a.value.Registrations;
                            const valueB = typeof b.value[2] === 'number' ? b.value[2] : b.value.Registrations;
                            return valueB - valueA;
                        });
                        
                        params.forEach(param => {
                            // ä¿®å¤ï¼šæ ¹æ®æ•°æ®ç»“æ„æ­£ç¡®è·å–å€¼
                            const value = typeof param.value[2] === 'number' ? 
                                          param.value[2] : 
                                          (param.value.Registrations !== undefined ? 
                                           param.value.Registrations : 
                                           param.value);
                            
                            const colorSpan = `<span style="display:inline-block;margin-right:5px;border-radius:10px;width:10px;height:10px;background-color:${param.color};"></span>`;
                            result += colorSpan + param.seriesName + ': ' + value + '<br>';
                        });
                        
                        return result;
                    }
                },
                xAxis: {
                    type: 'category',
                    nameLocation: 'middle',
                    axisLabel: {
                        formatter: function(value) {
                            // åªæ˜¾ç¤ºæœˆå’Œæ—¥
                            const date = new Date(value);
                            return (date.getMonth() + 1) + '-' + date.getDate();
                        }
                    }
                },
                yAxis: {
                    name: 'æ³¨å†Œäººæ•°',
                    nameTextStyle: {
                        padding: [0, 0, 0, 40]  // å¢åŠ åç§°ä¸è½´çš„è·ç¦»
                    }
                },
                grid: {
                    right: 140,
                    left: 80,
                    bottom: 80
                },
                legend: {
                    type: 'scroll',
                    orient: 'horizontal',
                    bottom: 10,
                    textStyle: {
                        color: '#333'
                    },
                    selectedMode: true
                },
                series: seriesList
            };
            
            myChart.setOption(option);
            
            // æ”¹ä¸ºä½¿ç”¨ rendered äº‹ä»¶ï¼Œåœ¨æ¸²æŸ“å®Œæˆåä¿®å¤ endLabel
            myChart.on('rendered', function() {
                // ç¡®ä¿å›¾è¡¨å·²æ­£ç¡®æ¸²æŸ“å¹¶åŒ…å«æ‰€æœ‰æ•°æ®ç‚¹
                platforms.forEach((platform, index) => {
                    // è·å–å¯¹åº”å¹³å°çš„æœ€åä¸€å¤©æ•°æ®
                    const lastDayValue = lastDayData[platform];
                    
                    // åœ¨åŠ¨ç”»å®Œæˆåï¼Œè®¾ç½®å›ºå®šçš„endLabel
                    myChart.setOption({
                        series: [{
                            name: platform,
                            endLabel: {
                                show: true,
                                formatter: platform + ': ' + lastDayValue,
                                backgroundColor: '#fff',
                                padding: [3, 5],
                                borderRadius: 3,
                                shadowColor: 'rgba(0, 0, 0, 0.1)',
                                shadowBlur: 3
                            }
                        }]
                    }, {replaceMerge: false, notMerge: false});
                });
            });
            
            // æ·»åŠ åˆ°window.resizeäº‹ä»¶å¤„ç†ä¸­
            if (window.echartInstances) {
                window.echartInstances.push(myChart);
            } else {
                window.echartInstances = [myChart];
            }
        }
    </script>
</body>
</html> 